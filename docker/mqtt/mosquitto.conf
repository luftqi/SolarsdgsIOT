# =================================================================
# SolarSDGs IoT - Mosquitto MQTT Broker Configuration
# Eclipse Mosquitto 2.x
# =================================================================

# === 基本設定 ===

# Broker ID
#clientid_prefixes

# 持久化設定
persistence true
persistence_location /mosquitto/data/

# 日誌設定
log_dest file /mosquitto/log/mosquitto.log
log_dest stdout
log_type error
log_type warning
log_type notice
log_type information
log_timestamp true
log_timestamp_format %Y-%m-%dT%H:%M:%S

# === MQTT 監聽器 (Port 1883) ===

# 標準 MQTT 協議
listener 1883
protocol mqtt

# 允許匿名連接 (生產環境建議改為 false 並設定用戶認證)
allow_anonymous true

# === WebSocket 監聽器 (Port 9001) ===

# WebSocket over MQTT for browser clients
listener 9001
protocol websockets

# 允許匿名連接
allow_anonymous true

# === 連接設定 ===

# 最大連接數 (預設: -1 無限制)
max_connections -1

# 客戶端 Keep Alive (秒)
# 0 = 不檢查, 預設 60 秒
#keepalive_interval 60

# === 消息設定 ===

# 最大消息大小 (bytes, 10MB = 10485760)
# Mosquitto 2.x 限制: 最大約 100MB
message_size_limit 10485760

# 訊息佇列大小
max_queued_messages 1000

# === 安全設定 (可選) ===

# 取消註解以啟用用戶認證
#password_file /mosquitto/config/password.txt

# ACL 存取控制
#acl_file /mosquitto/config/acl.txt

# === 橋接設定 (可選) ===
# 如需連接到其他 MQTT Broker

#connection bridge-01
#address mqtt.example.com:1883
#topic # both 0

# =================================================================
# 結束
# =================================================================
